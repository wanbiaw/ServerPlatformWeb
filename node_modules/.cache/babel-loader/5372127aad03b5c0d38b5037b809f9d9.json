{"remainingRequest":"F:\\ServerPlatformWeb\\node_modules\\babel-loader\\lib\\index.js!F:\\ServerPlatformWeb\\node_modules\\eslint-loader\\index.js??ref--14-0!F:\\ServerPlatformWeb\\src\\utils\\authority-utils.js","dependencies":[{"path":"F:\\ServerPlatformWeb\\src\\utils\\authority-utils.js","mtime":1651512164155},{"path":"F:\\ServerPlatformWeb\\babel.config.js","mtime":1651512117562},{"path":"F:\\ServerPlatformWeb\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1651512135878},{"path":"F:\\ServerPlatformWeb\\node_modules\\babel-loader\\lib\\index.js","mtime":1651512132831},{"path":"F:\\ServerPlatformWeb\\node_modules\\eslint-loader\\index.js","mtime":1651512148396}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyIGZyb20gIkY6L1NlcnZlclBsYXRmb3JtV2ViL25vZGVfbW9kdWxlcy9AYmFiZWwvcnVudGltZS9oZWxwZXJzL2VzbS9jcmVhdGVGb3JPZkl0ZXJhdG9ySGVscGVyLmpzIjsKaW1wb3J0IF90b0NvbnN1bWFibGVBcnJheSBmcm9tICJGOi9TZXJ2ZXJQbGF0Zm9ybVdlYi9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vdG9Db25zdW1hYmxlQXJyYXkuanMiOwppbXBvcnQgX3R5cGVvZiBmcm9tICJGOi9TZXJ2ZXJQbGF0Zm9ybVdlYi9ub2RlX21vZHVsZXMvQGJhYmVsL3J1bnRpbWUvaGVscGVycy9lc20vdHlwZW9mLmpzIjsKaW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuYXJyYXkuZmluZC1pbmRleC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmNvbmNhdC5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLmFycmF5LmZpbHRlci5qcyI7CmltcG9ydCAiY29yZS1qcy9tb2R1bGVzL2VzLm9iamVjdC50by1zdHJpbmcuanMiOwoKLyoqDQogKiDliKTmlq3mmK/lkKbmnInot6/nlLHnmoTmnYPpmZANCiAqIEBwYXJhbSBhdXRob3JpdHkg6Lev55Sx5p2D6ZmQ6YWN572uDQogKiBAcGFyYW0gcGVybWlzc2lvbnMg55So5oi35p2D6ZmQ6ZuG5ZCIDQogKiBAcmV0dXJucyB7Ym9vbGVhbnwqfQ0KICovCmZ1bmN0aW9uIGhhc1Blcm1pc3Npb24oYXV0aG9yaXR5LCBwZXJtaXNzaW9ucykgewogIHZhciByZXF1aXJlZCA9ICcqJzsKCiAgaWYgKHR5cGVvZiBhdXRob3JpdHkgPT09ICdzdHJpbmcnKSB7CiAgICByZXF1aXJlZCA9IGF1dGhvcml0eTsKICB9IGVsc2UgaWYgKF90eXBlb2YoYXV0aG9yaXR5KSA9PT0gJ29iamVjdCcpIHsKICAgIHJlcXVpcmVkID0gYXV0aG9yaXR5LnBlcm1pc3Npb247CiAgfQoKICByZXR1cm4gcmVxdWlyZWQgPT09ICcqJyB8fCBwZXJtaXNzaW9ucyAmJiBwZXJtaXNzaW9ucy5maW5kSW5kZXgoZnVuY3Rpb24gKGl0ZW0pIHsKICAgIHJldHVybiBpdGVtID09PSByZXF1aXJlZCB8fCBpdGVtLmlkID09PSByZXF1aXJlZDsKICB9KSAhPT0gLTE7Cn0KLyoqDQogKiDliKTmlq3mmK/lkKbmnInot6/nlLHpnIDopoHnmoTop5LoibINCiAqIEBwYXJhbSBhdXRob3JpdHkg6Lev55Sx5p2D6ZmQ6YWN572uDQogKiBAcGFyYW0gcm9sZXMg55So5oi36KeS6Imy6ZuG5ZCIDQogKi8KCgpmdW5jdGlvbiBoYXNSb2xlKGF1dGhvcml0eSwgcm9sZXMpIHsKICB2YXIgcmVxdWlyZWQgPSB1bmRlZmluZWQ7CgogIGlmIChfdHlwZW9mKGF1dGhvcml0eSkgPT09ICdvYmplY3QnKSB7CiAgICByZXF1aXJlZCA9IGF1dGhvcml0eS5yb2xlOwogIH0KCiAgcmV0dXJuIGF1dGhvcml0eSA9PT0gJyonIHx8IGhhc0FueVJvbGUocmVxdWlyZWQsIHJvbGVzKTsKfQovKioNCiAqIOWIpOaWreaYr+WQpuaciemcgOimgeeahOS7u+aEj+S4gOS4quinkuiJsg0KICogQHBhcmFtIHJlcXVpcmVkIHtTdHJpbmcgfCBBcnJheVtTdHJpbmddfSDpnIDopoHnmoTop5LoibLvvIzlj6/ku6XmmK/ljZXkuKrop5LoibLmiJbogIXkuIDkuKrop5LoibLmlbDnu4QNCiAqIEBwYXJhbSByb2xlcyDmi6XmnInnmoTop5LoibINCiAqIEByZXR1cm5zIHtib29sZWFufQ0KICovCgoKZnVuY3Rpb24gaGFzQW55Um9sZShyZXF1aXJlZCwgcm9sZXMpIHsKICBpZiAoIXJlcXVpcmVkKSB7CiAgICByZXR1cm4gZmFsc2U7CiAgfSBlbHNlIGlmIChBcnJheS5pc0FycmF5KHJlcXVpcmVkKSkgewogICAgcmV0dXJuIHJvbGVzLmZpbmRJbmRleChmdW5jdGlvbiAocm9sZSkgewogICAgICByZXR1cm4gcmVxdWlyZWQuZmluZEluZGV4KGZ1bmN0aW9uIChpdGVtKSB7CiAgICAgICAgcmV0dXJuIGl0ZW0gPT09IHJvbGUgfHwgaXRlbSA9PT0gcm9sZS5pZDsKICAgICAgfSkgIT09IC0xOwogICAgfSkgIT09IC0xOwogIH0gZWxzZSB7CiAgICByZXR1cm4gcm9sZXMuZmluZEluZGV4KGZ1bmN0aW9uIChyb2xlKSB7CiAgICAgIHJldHVybiByb2xlID09PSByZXF1aXJlZCB8fCByb2xlLmlkID09PSByZXF1aXJlZDsKICAgIH0pICE9PSAtMTsKICB9Cn0KLyoqDQogKiDot6/nlLHmnYPpmZDmoKHpqowNCiAqIEBwYXJhbSByb3V0ZSDot6/nlLENCiAqIEBwYXJhbSBwZXJtaXNzaW9ucyDnlKjmiLfmnYPpmZDpm4blkIgNCiAqIEBwYXJhbSByb2xlcyDnlKjmiLfop5LoibLpm4blkIgNCiAqIEByZXR1cm5zIHtib29sZWFufQ0KICovCgoKZnVuY3Rpb24gaGFzQXV0aG9yaXR5KHJvdXRlLCBwZXJtaXNzaW9ucywgcm9sZXMpIHsKICB2YXIgYXV0aG9yaXRpZXMgPSBbXS5jb25jYXQoX3RvQ29uc3VtYWJsZUFycmF5KHJvdXRlLm1ldGEucEF1dGhvcml0aWVzKSwgW3JvdXRlLm1ldGEuYXV0aG9yaXR5XSk7CgogIHZhciBfaXRlcmF0b3IgPSBfY3JlYXRlRm9yT2ZJdGVyYXRvckhlbHBlcihhdXRob3JpdGllcyksCiAgICAgIF9zdGVwOwoKICB0cnkgewogICAgZm9yIChfaXRlcmF0b3IucygpOyAhKF9zdGVwID0gX2l0ZXJhdG9yLm4oKSkuZG9uZTspIHsKICAgICAgdmFyIGF1dGhvcml0eSA9IF9zdGVwLnZhbHVlOwoKICAgICAgaWYgKCFoYXNQZXJtaXNzaW9uKGF1dGhvcml0eSwgcGVybWlzc2lvbnMpICYmICFoYXNSb2xlKGF1dGhvcml0eSwgcm9sZXMpKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICB9CiAgfSBjYXRjaCAoZXJyKSB7CiAgICBfaXRlcmF0b3IuZShlcnIpOwogIH0gZmluYWxseSB7CiAgICBfaXRlcmF0b3IuZigpOwogIH0KCiAgcmV0dXJuIHRydWU7Cn0KLyoqDQogKiDmoLnmja7mnYPpmZDphY3nva7ov4fmu6Toj5zljZXmlbDmja4NCiAqIEBwYXJhbSBtZW51RGF0YQ0KICogQHBhcmFtIHBlcm1pc3Npb25zDQogKiBAcGFyYW0gcm9sZXMNCiAqLwoKCmZ1bmN0aW9uIGZpbHRlck1lbnUobWVudURhdGEsIHBlcm1pc3Npb25zLCByb2xlcykgewogIHJldHVybiBtZW51RGF0YS5maWx0ZXIoZnVuY3Rpb24gKG1lbnUpIHsKICAgIGlmIChtZW51Lm1ldGEgJiYgbWVudS5tZXRhLmludmlzaWJsZSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgIGlmICghaGFzQXV0aG9yaXR5KG1lbnUsIHBlcm1pc3Npb25zLCByb2xlcykpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgIH0KCiAgICBpZiAobWVudS5jaGlsZHJlbiAmJiBtZW51LmNoaWxkcmVuLmxlbmd0aCA+IDApIHsKICAgICAgbWVudS5jaGlsZHJlbiA9IGZpbHRlck1lbnUobWVudS5jaGlsZHJlbiwgcGVybWlzc2lvbnMsIHJvbGVzKTsKICAgIH0KCiAgICByZXR1cm4gdHJ1ZTsKICB9KTsKfQoKZXhwb3J0IHsgZmlsdGVyTWVudSwgaGFzQXV0aG9yaXR5IH07"},{"version":3,"sources":["F:/ServerPlatformWeb/src/utils/authority-utils.js"],"names":["hasPermission","authority","permissions","required","permission","findIndex","item","id","hasRole","roles","undefined","role","hasAnyRole","Array","isArray","hasAuthority","route","authorities","meta","pAuthorities","filterMenu","menuData","filter","menu","invisible","children","length"],"mappings":"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","sourcesContent":["/**\r\n * 判断是否有路由的权限\r\n * @param authority 路由权限配置\r\n * @param permissions 用户权限集合\r\n * @returns {boolean|*}\r\n */\r\nfunction hasPermission(authority, permissions) {\r\n  let required = '*'\r\n  if (typeof authority === 'string') {\r\n    required = authority\r\n  } else if (typeof authority === 'object') {\r\n    required = authority.permission\r\n  }\r\n  return required === '*' || (permissions && permissions.findIndex(item => item === required || item.id === required) !== -1)\r\n}\r\n\r\n/**\r\n * 判断是否有路由需要的角色\r\n * @param authority 路由权限配置\r\n * @param roles 用户角色集合\r\n */\r\nfunction hasRole(authority, roles) {\r\n  let required = undefined\r\n  if (typeof authority === 'object') {\r\n    required = authority.role\r\n  }\r\n  return authority === '*' || hasAnyRole(required, roles)\r\n}\r\n\r\n/**\r\n * 判断是否有需要的任意一个角色\r\n * @param required {String | Array[String]} 需要的角色，可以是单个角色或者一个角色数组\r\n * @param roles 拥有的角色\r\n * @returns {boolean}\r\n */\r\nfunction hasAnyRole(required, roles) {\r\n  if (!required) {\r\n    return false\r\n  } else if(Array.isArray(required)) {\r\n    return roles.findIndex(role => {\r\n      return required.findIndex(item => item === role || item === role.id) !== -1\r\n    }) !== -1\r\n  } else {\r\n    return roles.findIndex(role => role === required || role.id === required) !== -1\r\n  }\r\n}\r\n\r\n/**\r\n * 路由权限校验\r\n * @param route 路由\r\n * @param permissions 用户权限集合\r\n * @param roles 用户角色集合\r\n * @returns {boolean}\r\n */\r\nfunction hasAuthority(route, permissions, roles) {\r\n  const authorities = [...route.meta.pAuthorities, route.meta.authority]\r\n  for (let authority of authorities) {\r\n    if (!hasPermission(authority, permissions) && !hasRole(authority, roles)) {\r\n      return false\r\n    }\r\n  }\r\n  return true\r\n}\r\n\r\n/**\r\n * 根据权限配置过滤菜单数据\r\n * @param menuData\r\n * @param permissions\r\n * @param roles\r\n */\r\nfunction filterMenu(menuData, permissions, roles) {\r\n  return menuData.filter(menu => {\r\n    if (menu.meta && menu.meta.invisible === undefined) {\r\n      if (!hasAuthority(menu, permissions, roles)) {\r\n        return false\r\n      }\r\n    }\r\n    if (menu.children && menu.children.length > 0) {\r\n      menu.children = filterMenu(menu.children, permissions, roles)\r\n    }\r\n    return true\r\n  })\r\n}\r\n\r\nexport {filterMenu, hasAuthority}\r\n"]}]}