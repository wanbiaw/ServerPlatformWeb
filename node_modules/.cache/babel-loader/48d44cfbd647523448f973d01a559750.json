{"remainingRequest":"D:\\ServerPlatformWeb\\node_modules\\babel-loader\\lib\\index.js!D:\\ServerPlatformWeb\\node_modules\\cache-loader\\dist\\cjs.js??ref--1-0!D:\\ServerPlatformWeb\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!D:\\ServerPlatformWeb\\src\\components\\table\\StandardTable.vue?vue&type=script&lang=js&","dependencies":[{"path":"D:\\ServerPlatformWeb\\src\\components\\table\\StandardTable.vue","mtime":1649217944428},{"path":"D:\\ServerPlatformWeb\\babel.config.js","mtime":1649217944413},{"path":"D:\\ServerPlatformWeb\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\ServerPlatformWeb\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000},{"path":"D:\\ServerPlatformWeb\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"D:\\ServerPlatformWeb\\node_modules\\vue-loader\\lib\\index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0IF9vYmplY3RTcHJlYWQgZnJvbSAiRDovU2VydmVyUGxhdGZvcm1XZWIvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL29iamVjdFNwcmVhZDIuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5tYXAuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5hcnJheS5maWx0ZXIuanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nLmpzIjsKLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICdTdGFuZGFyZFRhYmxlJywKICBwcm9wczogewogICAgYm9yZGVyZWQ6IEJvb2xlYW4sCiAgICBsb2FkaW5nOiBbQm9vbGVhbiwgT2JqZWN0XSwKICAgIGNvbHVtbnM6IEFycmF5LAogICAgZGF0YVNvdXJjZTogQXJyYXksCiAgICByb3dLZXk6IHsKICAgICAgdHlwZTogW1N0cmluZywgRnVuY3Rpb25dLAogICAgICBkZWZhdWx0OiAna2V5JwogICAgfSwKICAgIHBhZ2luYXRpb246IHsKICAgICAgdHlwZTogW09iamVjdCwgQm9vbGVhbl0sCiAgICAgIGRlZmF1bHQ6IHRydWUKICAgIH0sCiAgICBzZWxlY3RlZFJvd3M6IEFycmF5LAogICAgZXhwYW5kZWRSb3dLZXlzOiBBcnJheSwKICAgIGV4cGFuZGVkUm93UmVuZGVyOiBGdW5jdGlvbgogIH0sCiAgZGF0YTogZnVuY3Rpb24gZGF0YSgpIHsKICAgIHJldHVybiB7CiAgICAgIG5lZWRUb3RhbExpc3Q6IFtdCiAgICB9OwogIH0sCiAgbWV0aG9kczogewogICAgdXBkYXRlU2VsZWN0OiBmdW5jdGlvbiB1cGRhdGVTZWxlY3Qoc2VsZWN0ZWRSb3dLZXlzLCBzZWxlY3RlZFJvd3MpIHsKICAgICAgdGhpcy4kZW1pdCgndXBkYXRlOnNlbGVjdGVkUm93cycsIHNlbGVjdGVkUm93cyk7CiAgICAgIHRoaXMuJGVtaXQoJ3NlbGVjdGVkUm93Q2hhbmdlJywgc2VsZWN0ZWRSb3dLZXlzLCBzZWxlY3RlZFJvd3MpOwogICAgfSwKICAgIGluaXRUb3RhbExpc3Q6IGZ1bmN0aW9uIGluaXRUb3RhbExpc3QoY29sdW1ucykgewogICAgICB2YXIgdG90YWxMaXN0ID0gY29sdW1ucy5maWx0ZXIoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICByZXR1cm4gaXRlbS5uZWVkVG90YWw7CiAgICAgIH0pLm1hcChmdW5jdGlvbiAoaXRlbSkgewogICAgICAgIHJldHVybiBfb2JqZWN0U3ByZWFkKF9vYmplY3RTcHJlYWQoe30sIGl0ZW0pLCB7fSwgewogICAgICAgICAgdG90YWw6IDAKICAgICAgICB9KTsKICAgICAgfSk7CiAgICAgIHJldHVybiB0b3RhbExpc3Q7CiAgICB9LAogICAgb25DbGVhcjogZnVuY3Rpb24gb25DbGVhcigpIHsKICAgICAgdGhpcy51cGRhdGVTZWxlY3QoW10sIFtdKTsKICAgICAgdGhpcy4kZW1pdCgnY2xlYXInKTsKICAgIH0sCiAgICBvbkNoYW5nZTogZnVuY3Rpb24gb25DaGFuZ2UocGFnaW5hdGlvbiwgZmlsdGVycywgc29ydGVyLCBfcmVmKSB7CiAgICAgIHZhciBjdXJyZW50RGF0YVNvdXJjZSA9IF9yZWYuY3VycmVudERhdGFTb3VyY2U7CiAgICAgIHRoaXMuJGVtaXQoJ2NoYW5nZScsIHBhZ2luYXRpb24sIGZpbHRlcnMsIHNvcnRlciwgewogICAgICAgIGN1cnJlbnREYXRhU291cmNlOiBjdXJyZW50RGF0YVNvdXJjZQogICAgICB9KTsKICAgIH0KICB9LAogIGNyZWF0ZWQ6IGZ1bmN0aW9uIGNyZWF0ZWQoKSB7CiAgICB0aGlzLm5lZWRUb3RhbExpc3QgPSB0aGlzLmluaXRUb3RhbExpc3QodGhpcy5jb2x1bW5zKTsKICB9LAogIHdhdGNoOiB7CiAgICBzZWxlY3RlZFJvd3M6IGZ1bmN0aW9uIHNlbGVjdGVkUm93cyhfc2VsZWN0ZWRSb3dzKSB7CiAgICAgIHRoaXMubmVlZFRvdGFsTGlzdCA9IHRoaXMubmVlZFRvdGFsTGlzdC5tYXAoZnVuY3Rpb24gKGl0ZW0pIHsKICAgICAgICByZXR1cm4gX29iamVjdFNwcmVhZChfb2JqZWN0U3ByZWFkKHt9LCBpdGVtKSwge30sIHsKICAgICAgICAgIHRvdGFsOiBfc2VsZWN0ZWRSb3dzLnJlZHVjZShmdW5jdGlvbiAoc3VtLCB2YWwpIHsKICAgICAgICAgICAgdmFyIHY7CgogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgIHYgPSB2YWxbaXRlbS5kYXRhSW5kZXhdID8gdmFsW2l0ZW0uZGF0YUluZGV4XSA6IGV2YWwoInZhbC4iLmNvbmNhdChpdGVtLmRhdGFJbmRleCkpOwogICAgICAgICAgICB9IGNhdGNoIChfKSB7CiAgICAgICAgICAgICAgdiA9IHZhbFtpdGVtLmRhdGFJbmRleF07CiAgICAgICAgICAgIH0KCiAgICAgICAgICAgIHYgPSAhaXNOYU4ocGFyc2VGbG9hdCh2KSkgPyBwYXJzZUZsb2F0KHYpIDogMDsKICAgICAgICAgICAgcmV0dXJuIHN1bSArIHY7CiAgICAgICAgICB9LCAwKQogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0KICB9LAogIGNvbXB1dGVkOiB7CiAgICBzZWxlY3RlZFJvd0tleXM6IGZ1bmN0aW9uIHNlbGVjdGVkUm93S2V5cygpIHsKICAgICAgdmFyIF90aGlzID0gdGhpczsKCiAgICAgIHJldHVybiB0aGlzLnNlbGVjdGVkUm93cy5tYXAoZnVuY3Rpb24gKHJlY29yZCkgewogICAgICAgIHJldHVybiB0eXBlb2YgX3RoaXMucm93S2V5ID09PSAnZnVuY3Rpb24nID8gX3RoaXMucm93S2V5KHJlY29yZCkgOiByZWNvcmRbX3RoaXMucm93S2V5XTsKICAgICAgfSk7CiAgICB9CiAgfQp9Ow=="},{"version":3,"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyCA;AACAA,uBADA;AAEAC;AACAC,qBADA;AAEAC,8BAFA;AAGAC,kBAHA;AAIAC,qBAJA;AAKAC;AACAC,8BADA;AAEAC;AAFA,KALA;AASAC;AACAF,6BADA;AAEAC;AAFA,KATA;AAaAE,uBAbA;AAcAC,0BAdA;AAeAC;AAfA,GAFA;AAmBAC,MAnBA,kBAmBA;AACA;AACAC;AADA;AAGA,GAvBA;AAwBAC;AACAC,gBADA,wBACAC,eADA,EACAP,YADA,EACA;AACA;AACA;AACA,KAJA;AAKAQ,iBALA,yBAKAd,OALA,EAKA;AACA;AAAA;AAAA,SACAe,GADA,CACA;AACA,+CACAC,IADA;AAEAC;AAFA;AAIA,OANA;AAOA;AACA,KAdA;AAeAC,WAfA,qBAeA;AACA;AACA;AACA,KAlBA;AAmBAC,YAnBA,oBAmBAd,UAnBA,EAmBAe,OAnBA,EAmBAC,MAnBA,QAmBA;AAAA;AACA;AAAAC;AAAA;AACA;AArBA,GAxBA;AA+CAC,SA/CA,qBA+CA;AACA;AACA,GAjDA;AAkDAC;AACAlB,gBADA,wBACAA,aADA,EACA;AACA;AACA,+CACAU,IADA;AAEAC;AACA;;AACA;AACAQ;AACA,aAFA,CAEA;AACAA;AACA;;AACAA;AACA;AACA,WATA,EASA,CATA;AAFA;AAaA,OAdA;AAeA;AAjBA,GAlDA;AAqEAC;AACAb,mBADA,6BACA;AAAA;;AACA;AACA;AACA,OAFA;AAGA;AALA;AArEA","names":["name","props","bordered","loading","columns","dataSource","rowKey","type","default","pagination","selectedRows","expandedRowKeys","expandedRowRender","data","needTotalList","methods","updateSelect","selectedRowKeys","initTotalList","map","item","total","onClear","onChange","filters","sorter","currentDataSource","created","watch","v","computed"],"sourceRoot":"src/components/table","sources":["StandardTable.vue"],"sourcesContent":["<template>\r\n  <div class=\"standard-table\">\r\n    <div class=\"alert\">\r\n      <a-alert type=\"info\" :show-icon=\"true\" v-if=\"selectedRows\">\r\n        <div class=\"message\" slot=\"message\">\r\n          已选择&nbsp;<a>{{selectedRows.length}}</a>&nbsp;项 <a class=\"clear\" @click=\"onClear\">清空</a>\r\n          <template  v-for=\"(item, index) in needTotalList\" >\r\n            <div v-if=\"item.needTotal\" :key=\"index\">\r\n              {{item.title}}总计&nbsp;\r\n              <a>{{item.customRender ? item.customRender(item.total) : item.total}}</a>\r\n            </div>\r\n          </template>\r\n        </div>\r\n      </a-alert>\r\n    </div>\r\n    <a-table\r\n      :bordered=\"bordered\"\r\n      :loading=\"loading\"\r\n      :columns=\"columns\"\r\n      :dataSource=\"dataSource\"\r\n      :rowKey=\"rowKey\"\r\n      :pagination=\"pagination\"\r\n      :expandedRowKeys=\"expandedRowKeys\"\r\n      :expandedRowRender=\"expandedRowRender\"\r\n      @change=\"onChange\"\r\n      :rowSelection=\"selectedRows ? {selectedRowKeys: selectedRowKeys, onChange: updateSelect} : undefined\"\r\n    >\r\n      <template slot-scope=\"text, record, index\" :slot=\"slot\" v-for=\"slot in Object.keys($scopedSlots).filter(key => key !== 'expandedRowRender') \">\r\n        <slot :name=\"slot\" v-bind=\"{text, record, index}\"></slot>\r\n      </template>\r\n      <template :slot=\"slot\" v-for=\"slot in Object.keys($slots)\">\r\n        <slot :name=\"slot\"></slot>\r\n      </template>\r\n      <template slot-scope=\"record, index, indent, expanded\" :slot=\"$scopedSlots.expandedRowRender ? 'expandedRowRender' : ''\">\r\n        <slot v-bind=\"{record, index, indent, expanded}\" :name=\"$scopedSlots.expandedRowRender ? 'expandedRowRender' : ''\"></slot>\r\n      </template>\r\n    </a-table>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: 'StandardTable',\r\n  props: {\r\n    bordered: Boolean,\r\n    loading: [Boolean, Object],\r\n    columns: Array,\r\n    dataSource: Array,\r\n    rowKey: {\r\n      type: [String, Function],\r\n      default: 'key'\r\n    },\r\n    pagination: {\r\n      type: [Object, Boolean],\r\n      default: true\r\n    },\r\n    selectedRows: Array,\r\n    expandedRowKeys: Array,\r\n    expandedRowRender: Function\r\n  },\r\n  data () {\r\n    return {\r\n      needTotalList: []\r\n    }\r\n  },\r\n  methods: {\r\n    updateSelect (selectedRowKeys, selectedRows) {\r\n      this.$emit('update:selectedRows', selectedRows)\r\n      this.$emit('selectedRowChange', selectedRowKeys, selectedRows)\r\n    },\r\n    initTotalList (columns) {\r\n      const totalList = columns.filter(item => item.needTotal)\r\n        .map(item => {\r\n          return {\r\n            ...item,\r\n            total: 0\r\n          }\r\n        })\r\n      return totalList\r\n    },\r\n    onClear() {\r\n      this.updateSelect([], [])\r\n      this.$emit('clear')\r\n    },\r\n    onChange(pagination, filters, sorter, {currentDataSource}) {\r\n      this.$emit('change', pagination, filters, sorter, {currentDataSource})\r\n    }\r\n  },\r\n  created () {\r\n    this.needTotalList = this.initTotalList(this.columns)\r\n  },\r\n  watch: {\r\n    selectedRows (selectedRows) {\r\n      this.needTotalList = this.needTotalList.map(item => {\r\n        return {\r\n          ...item,\r\n          total: selectedRows.reduce((sum, val) => {\r\n            let v\r\n            try{\r\n              v = val[item.dataIndex] ? val[item.dataIndex] : eval(`val.${item.dataIndex}`);\r\n            }catch(_){\r\n              v = val[item.dataIndex];\r\n            }\r\n            v = !isNaN(parseFloat(v)) ? parseFloat(v) : 0;\r\n            return sum + v\r\n          }, 0)\r\n        }\r\n      })\r\n    }\r\n  },\r\n  computed: {\r\n    selectedRowKeys() {\r\n      return this.selectedRows.map(record => {\r\n        return (typeof this.rowKey === 'function') ? this.rowKey(record) : record[this.rowKey]\r\n      })\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n.standard-table{\r\n  .alert{\r\n    margin-bottom: 16px;\r\n    .message{\r\n      a{\r\n        font-weight: 600;\r\n      }\r\n    }\r\n    .clear{\r\n      float: right;\r\n    }\r\n  }\r\n}\r\n</style>\r\n"]}]}