{"remainingRequest":"F:\\ServerPlatformWeb\\node_modules\\vue-loader\\lib\\index.js??vue-loader-options!F:\\ServerPlatformWeb\\src\\components\\table\\StandardTable.vue?vue&type=script&lang=js&","dependencies":[{"path":"F:\\ServerPlatformWeb\\src\\components\\table\\StandardTable.vue","mtime":1651512164087},{"path":"F:\\ServerPlatformWeb\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1651512135878},{"path":"F:\\ServerPlatformWeb\\node_modules\\babel-loader\\lib\\index.js","mtime":1651512132831},{"path":"F:\\ServerPlatformWeb\\node_modules\\cache-loader\\dist\\cjs.js","mtime":1651512135878},{"path":"F:\\ServerPlatformWeb\\node_modules\\vue-loader\\lib\\index.js","mtime":1651512162163}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KDQpleHBvcnQgZGVmYXVsdCB7DQogIG5hbWU6ICdTdGFuZGFyZFRhYmxlJywNCiAgcHJvcHM6IHsNCiAgICBib3JkZXJlZDogQm9vbGVhbiwNCiAgICBsb2FkaW5nOiBbQm9vbGVhbiwgT2JqZWN0XSwNCiAgICBjb2x1bW5zOiBBcnJheSwNCiAgICBkYXRhU291cmNlOiBBcnJheSwNCiAgICByb3dLZXk6IHsNCiAgICAgIHR5cGU6IFtTdHJpbmcsIEZ1bmN0aW9uXSwNCiAgICAgIGRlZmF1bHQ6ICdrZXknDQogICAgfSwNCiAgICBwYWdpbmF0aW9uOiB7DQogICAgICB0eXBlOiBbT2JqZWN0LCBCb29sZWFuXSwNCiAgICAgIGRlZmF1bHQ6IHRydWUNCiAgICB9LA0KICAgIHNlbGVjdGVkUm93czogQXJyYXksDQogICAgZXhwYW5kZWRSb3dLZXlzOiBBcnJheSwNCiAgICBleHBhbmRlZFJvd1JlbmRlcjogRnVuY3Rpb24NCiAgfSwNCiAgZGF0YSAoKSB7DQogICAgcmV0dXJuIHsNCiAgICAgIG5lZWRUb3RhbExpc3Q6IFtdDQogICAgfQ0KICB9LA0KICBtZXRob2RzOiB7DQogICAgdXBkYXRlU2VsZWN0IChzZWxlY3RlZFJvd0tleXMsIHNlbGVjdGVkUm93cykgew0KICAgICAgdGhpcy4kZW1pdCgndXBkYXRlOnNlbGVjdGVkUm93cycsIHNlbGVjdGVkUm93cykNCiAgICAgIHRoaXMuJGVtaXQoJ3NlbGVjdGVkUm93Q2hhbmdlJywgc2VsZWN0ZWRSb3dLZXlzLCBzZWxlY3RlZFJvd3MpDQogICAgfSwNCiAgICBpbml0VG90YWxMaXN0IChjb2x1bW5zKSB7DQogICAgICBjb25zdCB0b3RhbExpc3QgPSBjb2x1bW5zLmZpbHRlcihpdGVtID0+IGl0ZW0ubmVlZFRvdGFsKQ0KICAgICAgICAubWFwKGl0ZW0gPT4gew0KICAgICAgICAgIHJldHVybiB7DQogICAgICAgICAgICAuLi5pdGVtLA0KICAgICAgICAgICAgdG90YWw6IDANCiAgICAgICAgICB9DQogICAgICAgIH0pDQogICAgICByZXR1cm4gdG90YWxMaXN0DQogICAgfSwNCiAgICBvbkNsZWFyKCkgew0KICAgICAgdGhpcy51cGRhdGVTZWxlY3QoW10sIFtdKQ0KICAgICAgdGhpcy4kZW1pdCgnY2xlYXInKQ0KICAgIH0sDQogICAgb25DaGFuZ2UocGFnaW5hdGlvbiwgZmlsdGVycywgc29ydGVyLCB7Y3VycmVudERhdGFTb3VyY2V9KSB7DQogICAgICB0aGlzLiRlbWl0KCdjaGFuZ2UnLCBwYWdpbmF0aW9uLCBmaWx0ZXJzLCBzb3J0ZXIsIHtjdXJyZW50RGF0YVNvdXJjZX0pDQogICAgfQ0KICB9LA0KICBjcmVhdGVkICgpIHsNCiAgICB0aGlzLm5lZWRUb3RhbExpc3QgPSB0aGlzLmluaXRUb3RhbExpc3QodGhpcy5jb2x1bW5zKQ0KICB9LA0KICB3YXRjaDogew0KICAgIHNlbGVjdGVkUm93cyAoc2VsZWN0ZWRSb3dzKSB7DQogICAgICB0aGlzLm5lZWRUb3RhbExpc3QgPSB0aGlzLm5lZWRUb3RhbExpc3QubWFwKGl0ZW0gPT4gew0KICAgICAgICByZXR1cm4gew0KICAgICAgICAgIC4uLml0ZW0sDQogICAgICAgICAgdG90YWw6IHNlbGVjdGVkUm93cy5yZWR1Y2UoKHN1bSwgdmFsKSA9PiB7DQogICAgICAgICAgICBsZXQgdg0KICAgICAgICAgICAgdHJ5ew0KICAgICAgICAgICAgICB2ID0gdmFsW2l0ZW0uZGF0YUluZGV4XSA/IHZhbFtpdGVtLmRhdGFJbmRleF0gOiBldmFsKGB2YWwuJHtpdGVtLmRhdGFJbmRleH1gKTsNCiAgICAgICAgICAgIH1jYXRjaChfKXsNCiAgICAgICAgICAgICAgdiA9IHZhbFtpdGVtLmRhdGFJbmRleF07DQogICAgICAgICAgICB9DQogICAgICAgICAgICB2ID0gIWlzTmFOKHBhcnNlRmxvYXQodikpID8gcGFyc2VGbG9hdCh2KSA6IDA7DQogICAgICAgICAgICByZXR1cm4gc3VtICsgdg0KICAgICAgICAgIH0sIDApDQogICAgICAgIH0NCiAgICAgIH0pDQogICAgfQ0KICB9LA0KICBjb21wdXRlZDogew0KICAgIHNlbGVjdGVkUm93S2V5cygpIHsNCiAgICAgIHJldHVybiB0aGlzLnNlbGVjdGVkUm93cy5tYXAocmVjb3JkID0+IHsNCiAgICAgICAgcmV0dXJuICh0eXBlb2YgdGhpcy5yb3dLZXkgPT09ICdmdW5jdGlvbicpID8gdGhpcy5yb3dLZXkocmVjb3JkKSA6IHJlY29yZFt0aGlzLnJvd0tleV0NCiAgICAgIH0pDQogICAgfQ0KICB9DQp9DQo="},{"version":3,"sources":["StandardTable.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAyCA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"StandardTable.vue","sourceRoot":"src/components/table","sourcesContent":["<template>\r\n  <div class=\"standard-table\">\r\n    <div class=\"alert\">\r\n      <a-alert type=\"info\" :show-icon=\"true\" v-if=\"selectedRows\">\r\n        <div class=\"message\" slot=\"message\">\r\n          已选择&nbsp;<a>{{selectedRows.length}}</a>&nbsp;项 <a class=\"clear\" @click=\"onClear\">清空</a>\r\n          <template  v-for=\"(item, index) in needTotalList\" >\r\n            <div v-if=\"item.needTotal\" :key=\"index\">\r\n              {{item.title}}总计&nbsp;\r\n              <a>{{item.customRender ? item.customRender(item.total) : item.total}}</a>\r\n            </div>\r\n          </template>\r\n        </div>\r\n      </a-alert>\r\n    </div>\r\n    <a-table\r\n      :bordered=\"bordered\"\r\n      :loading=\"loading\"\r\n      :columns=\"columns\"\r\n      :dataSource=\"dataSource\"\r\n      :rowKey=\"rowKey\"\r\n      :pagination=\"pagination\"\r\n      :expandedRowKeys=\"expandedRowKeys\"\r\n      :expandedRowRender=\"expandedRowRender\"\r\n      @change=\"onChange\"\r\n      :rowSelection=\"selectedRows ? {selectedRowKeys: selectedRowKeys, onChange: updateSelect} : undefined\"\r\n    >\r\n      <template slot-scope=\"text, record, index\" :slot=\"slot\" v-for=\"slot in Object.keys($scopedSlots).filter(key => key !== 'expandedRowRender') \">\r\n        <slot :name=\"slot\" v-bind=\"{text, record, index}\"></slot>\r\n      </template>\r\n      <template :slot=\"slot\" v-for=\"slot in Object.keys($slots)\">\r\n        <slot :name=\"slot\"></slot>\r\n      </template>\r\n      <template slot-scope=\"record, index, indent, expanded\" :slot=\"$scopedSlots.expandedRowRender ? 'expandedRowRender' : ''\">\r\n        <slot v-bind=\"{record, index, indent, expanded}\" :name=\"$scopedSlots.expandedRowRender ? 'expandedRowRender' : ''\"></slot>\r\n      </template>\r\n    </a-table>\r\n  </div>\r\n</template>\r\n\r\n<script>\r\nexport default {\r\n  name: 'StandardTable',\r\n  props: {\r\n    bordered: Boolean,\r\n    loading: [Boolean, Object],\r\n    columns: Array,\r\n    dataSource: Array,\r\n    rowKey: {\r\n      type: [String, Function],\r\n      default: 'key'\r\n    },\r\n    pagination: {\r\n      type: [Object, Boolean],\r\n      default: true\r\n    },\r\n    selectedRows: Array,\r\n    expandedRowKeys: Array,\r\n    expandedRowRender: Function\r\n  },\r\n  data () {\r\n    return {\r\n      needTotalList: []\r\n    }\r\n  },\r\n  methods: {\r\n    updateSelect (selectedRowKeys, selectedRows) {\r\n      this.$emit('update:selectedRows', selectedRows)\r\n      this.$emit('selectedRowChange', selectedRowKeys, selectedRows)\r\n    },\r\n    initTotalList (columns) {\r\n      const totalList = columns.filter(item => item.needTotal)\r\n        .map(item => {\r\n          return {\r\n            ...item,\r\n            total: 0\r\n          }\r\n        })\r\n      return totalList\r\n    },\r\n    onClear() {\r\n      this.updateSelect([], [])\r\n      this.$emit('clear')\r\n    },\r\n    onChange(pagination, filters, sorter, {currentDataSource}) {\r\n      this.$emit('change', pagination, filters, sorter, {currentDataSource})\r\n    }\r\n  },\r\n  created () {\r\n    this.needTotalList = this.initTotalList(this.columns)\r\n  },\r\n  watch: {\r\n    selectedRows (selectedRows) {\r\n      this.needTotalList = this.needTotalList.map(item => {\r\n        return {\r\n          ...item,\r\n          total: selectedRows.reduce((sum, val) => {\r\n            let v\r\n            try{\r\n              v = val[item.dataIndex] ? val[item.dataIndex] : eval(`val.${item.dataIndex}`);\r\n            }catch(_){\r\n              v = val[item.dataIndex];\r\n            }\r\n            v = !isNaN(parseFloat(v)) ? parseFloat(v) : 0;\r\n            return sum + v\r\n          }, 0)\r\n        }\r\n      })\r\n    }\r\n  },\r\n  computed: {\r\n    selectedRowKeys() {\r\n      return this.selectedRows.map(record => {\r\n        return (typeof this.rowKey === 'function') ? this.rowKey(record) : record[this.rowKey]\r\n      })\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"less\">\r\n.standard-table{\r\n  .alert{\r\n    margin-bottom: 16px;\r\n    .message{\r\n      a{\r\n        font-weight: 600;\r\n      }\r\n    }\r\n    .clear{\r\n      float: right;\r\n    }\r\n  }\r\n}\r\n</style>\r\n"]}]}